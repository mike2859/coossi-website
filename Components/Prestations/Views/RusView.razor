@using Coossi.Blazor.Components.Shared
@using Coossi.Blazor.Data.Interfaces
@using Coossi.Blazor.Data.Models
@using Coossi.Blazor.Data.Models.Prestations
@inject IContentStore Content
@inject NavigationManager Nav

@code {
  [Parameter] public string Slug { get; set; } = "";
  private RusPage? Model;
  protected override async Task OnParametersSetAsync()
    => Model = await Content.GetAsync<RusPage>($"prestations/{Slug}");
  string Canonical => $"{Nav.BaseUri.TrimEnd('/')}/prestation/{Slug}";
}

@if (Model is null) { <section class="content-section"><div class="container">Chargement…</div></section> }
else {
  <Seo Title="@Model.Seo.MetaTitle" Description="@Model.Seo.MetaDescription" Canonical="@Canonical" OgImage="@(Model.Seo.OgImage ?? "images/og-prestations.webp")" />
  <PageHeader Title="@Model.Hero.Title" Lead="@Model.Hero.Subtitle" />

  <section class="content-section"><div class="container"><div class="info-card highlight-box">
    <h3>Depuis 2021</h3><p>@Model.SinceText</p>
  </div></div></section>

  <section class="content-section"><div class="container"><div class="info-card"><h2 class="section-title">Qu’est-ce que le RUS ?</h2><p>@Model.QuEstCeQueText</p></div></div></section>

  <section class="content-section"><div class="container"><div class="info-card"><h2 class="section-title">Cadre légal & responsabilités</h2><p>@Model.CadreLegalText</p></div></div></section>

  <section class="content-section"><div class="container"><div class="info-card highlight-box">
    <h3>Engagement de responsabilité</h3><p>@Model.EngagementText</p>
  </div></div></section>

  <section class="content-section"><div class="container"><div class="info-card"><h2 class="section-title">COOSSI assume ce rôle</h2><p>@Model.CoossiRoleText</p></div></div></section>

  <section class="content-section"><div class="container"><h2 class="section-title">Notre méthodologie</h2>
    <div class="row">@for (int i=0;i<Model.Methodologie.Count;i++){
      var it = Model.Methodologie[i];
      <div class="col-lg-4 mb-4"><div class="info-card h-100"><div class="number-badge">@((i+1).ToString())</div>
        <h3>@it.Title</h3>@if (!string.IsNullOrWhiteSpace(it.Text)){<p>@it.Text</p>}
      </div></div> }
    </div>
  </div></section>

  <section class="content-section"><div class="container"><h2 class="section-title">Missions du RUS</h2>
    <div class="row">@foreach (var m in Model.Missions){
      <div class="col-lg-6 mb-4"><div class="info-card h-100"><h3>@m.Title</h3>
        @if (m.Bullets is {Count:>0}){ <ul>@foreach (var b in m.Bullets!){ <li>@b</li> }</ul> }
      </div></div> }
    </div>
  </div></section>

  <section class="content-section"><div class="container"><h2 class="section-title">Établissements concernés</h2>
    <div class="row">@foreach (var e in Model.Etablissements){
      <div class="col-lg-4 mb-4"><div class="info-card h-100 text-center">
        @if (!string.IsNullOrWhiteSpace(e.Icon)) { <i class="fas @e.Icon fa-3x mb-2" style="color:var(--primary-color);"></i> }
        <h3>@e.Title</h3>@if (!string.IsNullOrWhiteSpace(e.Text)){<p>@e.Text</p>}
      </div></div> }
    </div>
  </div></section>

  <section class="content-section"><div class="container"><h2 class="section-title">Avantages de faire appel à COOSSI</h2>
    <div class="row">@foreach (var a in Model.Avantages){
      <div class="col-lg-3 mb-4"><div class="info-card h-100 text-center">
        @if (!string.IsNullOrWhiteSpace(a.Icon)) { <i class="fas @a.Icon fa-2x mb-2" style="color:var(--primary-color);"></i> }
        <h3>@a.Title</h3>@if (!string.IsNullOrWhiteSpace(a.Text)){<p>@a.Text</p>}
      </div></div> }
    </div>
  </div></section>

  <section class="content-section"><div class="container"><div class="info-card text-center">
    <h3>Nous confier le rôle de RUS</h3><p>@Model.ContactText</p><a class="btn-primary-custom" href="/contact">Demander des informations</a>
  </div></div></section>

  <section class="content-section"><div class="container"><h2 class="section-title">Zones d’intervention</h2><div class="city-links">
    @foreach (var c in Model.Cities) { <a>@c</a> }
  </div></div></section>

  <CtaBar Title="@Model.Cta.Title" Text="@Model.Cta.Text" CtaText="@Model.Cta.ButtonText" CtaHref="@Model.Cta.ButtonHref" IconClass="fas fa-comments" />
}
