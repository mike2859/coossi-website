@using Coossi.Blazor.Components.Shared
@using Coossi.Blazor.Data.Interfaces
@using Coossi.Blazor.Data.Models
@using Coossi.Blazor.Data.Models.Prestations
@inject IContentStore Store
@inject NavigationManager Nav


@code {
    [Parameter] public string Slug { get; set; } = "";
    private CoordinationPage? Model;
    protected override async Task OnParametersSetAsync()
      => Model = await Store.GetAsync<CoordinationPage>($"prestations/{Slug}");
    string Canonical => $"{Nav.BaseUri.TrimEnd('/')}/prestation/{Slug}";
}


@if (Model is null)
{
    <section class="content-section"><div class="container">Chargement…</div></section>
}
else
{
    <Seo Title="@Model.Seo.MetaTitle" Description="@Model.Seo.MetaDescription" Canonical="@Canonical" OgImage="@(Model.Seo.OgImage ?? "images/og-prestations.webp")" />
   @*  <PageHeader Title="@Model.Hero.Title" Lead="@Model.Hero.Subtitle" />
 *@
    <!-- BREADCRUMB -->
    <section class="breadcrumb-nav" style="margin-top: 76px;">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Accueil</a></li>
                    <li class="breadcrumb-item"><a href="/prestations">Prestations</a></li>
                    <li class="breadcrumb-item active">Coordination SSI</li>
                </ol>
            </nav>
        </div>
    </section>

    <!-- HERO -->
    <section class="hero-section" style="margin-top:76px;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-10">
                    <h1 class="display-5 fw-bold mb-2">
                        <i class="@Model.Hero.Icon me-2"></i>@Model.Hero.Title
                    </h1>
                    <p class="lead mb-0">@Model.Hero.Subtitle</p>
                </div>
            </div>
        </div>
    </section>

  <!-- CONTENU PRINCIPAL -->
    <section class="content-section">
        <div class="container">

            <!-- INTRO -->
            <div class="row mb-5">
                <div class="col-lg-12">
                    <div class="info-card">
                        <h3><i class="fas fa-info-circle me-2"></i>@Model.Intro.Title</h3>
                        @foreach (var p in Model.Intro.Paragraphs) { <p>@p</p> }
                    </div>
                </div>
            </div>

            <!-- CADRE LEGAL -->
            <div class="row mb-5">
                <div class="col-lg-12">
                    <h2 class="section-title">@Model.Legal.Title</h2>
                    <div class="info-card">
                        @foreach (var p in Model.Legal.Paragraphs) { <p>@p</p> }
                        
                    </div>
                </div>
            </div>

            <!-- MISSIONS -->
            <div class="row mb-5">
                <div class="col-lg-12">
                    <h2 class="section-title">@Model.Missions.Title</h2>
                    <p>@Model.Missions.Lead</p>

                    <div class="row">
                        @foreach (var it in Model.Missions.Items)
                        {
                            <div class="col-lg-6 mb-4">
                                <div class="info-card h-100">
                                    <h3><i class="@it.Icon me-2"></i>@it.Title</h3>
                                    <ul>
                                        @foreach (var b in it.Bullets) { <li>@b</li> }
                                    </ul>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- MÉTHODO -->
         @*    <div class="row mb-5">
                <div class="col-lg-12">
                    <h2 class="section-title">@Model.Methodo.Title</h2>
                    <p>@Model.Methodo.Lead</p>

                    <div class="row">
                        @foreach (var s in Model.Methodo.Steps)
                        {
                            <div class="col-lg-3 mb-3">
                                <div class="info-card h-100">
                                    <h3 class="text-center">@s.Title</h3>
                                    <ul>
                                        @foreach (var b in s.Bullets)
                                        {
                                            <li>@b</li>
                                        }
                                    </ul>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div> *@

            <!-- ÉTABLISSEMENTS CONCERNÉS -->
            <div class="row mb-5">
                <div class="col-lg-12">
                    <h2 class="section-title">@Model.Establishments.Title</h2>
                    <div class="row">
                        @foreach (var e in Model.Establishments.Items)
                        {
                            <div class="col-lg-3 col-md-6 mb-4">
                                <div class="info-card text-center h-100">
                                    <i class="@e.Icon fa-3x mb-3" style="color: var(--primary);"></i>
                                    <h3>@e.Title</h3>
                                    <p>@e.Subtitle</p>
                                    <p class="small text-muted mb-0">@e.Small</p>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- AVANTAGES -->
            <div class="row mb-5">
                <div class="col-lg-12">
                    <div class="highlight-box">
                        <h4><i class="fas fa-star me-2"></i>@Model.Advantages.Title</h4>
                        <div class="row mt-3">
                            <div class="col-lg-6">
                                <ul>
                                    @foreach (var b in Model.Advantages.LeftBullets) { <li>@b</li> }
                                </ul>
                            </div>
                            <div class="col-lg-6">
                                <ul>
                                    @foreach (var b in Model.Advantages.RightBullets) { <li>@b</li> }
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CONTACT -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="info-card text-center">
                        <h3><i class="fas fa-phone-alt me-2"></i>@Model.Contact.Title</h3>
                        <p>@Model.Contact.Text</p>
                        <p class="mb-4">
                            <strong>Téléphone :</strong>
                            <a href="@Model.Contact.PhoneHref" style="color: var(--primary); font-weight: bold; font-size: 1.3rem;">
                                @Model.Contact.PhoneDisplay
                            </a>
                        </p>
                        <a href="@Model.Contact.ButtonHref" class="btn-primary-custom">
                            <i class="fas fa-envelope me-2"></i>@Model.Contact.ButtonText
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </section>
    
    
    <!-- VILLES -->
    <section class="section-padding bg-light">
        <div class="container">
            <div class="cities-cloud">
                <h3 class="fw-bold"><i class="fas fa-map-marker-alt me-2"></i>Zones d'intervention - Coordination SSI</h3>
                <p class="lead mb-4">@Model.CitiesIntro</p>
                <div>
                    @foreach (var c in Model.Cities)
                    {
                        <a class="city-link" href="#">@c</a>
                    }
                </div>
                <div class="mt-4">
                    <small class="text-muted"><strong>Mots-clés :</strong> @string.Join(", ", Model.Keywords)</small>
                </div>
            </div>
        </div>
    </section>


    @* <CtaBar Title="@Model.Cta.Title" Text="@Model.Cta.Text" CtaText="@Model.Cta.ButtonText" CtaHref="@Model.Cta.ButtonHref" IconClass="fas fa-comments" /> *@
}
