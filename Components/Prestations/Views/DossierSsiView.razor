@using Coossi.Blazor.Components.Shared
@using Coossi.Blazor.Data.Interfaces
@using Coossi.Blazor.Data.Models
@using Coossi.Blazor.Data.Models.Prestations
@inject IContentStore Content
@inject NavigationManager Nav

@code {
  [Parameter] public string Slug { get; set; } = "";
  private DossierSsiPage? Model;

  protected override async Task OnParametersSetAsync()
      => Model = await Content.GetAsync<DossierSsiPage>($"prestations/{Slug}");

  string Canonical => $"{Nav.BaseUri.TrimEnd('/')}/prestation/{Slug}";
}

@if (Model is null)
{
  <section class="content-section"><div class="container text-muted">Chargement…</div></section>
}
else
{
  <Seo Title="@Model.Seo.MetaTitle" Description="@Model.Seo.MetaDescription" Canonical="@Canonical" OgImage="@(Model.Seo.OgImage ?? "images/og-prestations.webp")" />
  <PageHeader Title="@Model.Hero.Title" Lead="@Model.Hero.Subtitle" />

  <section class="content-section"><div class="container"><div class="info-card"><p>@Model.IntroText</p></div></div></section>

  <section class="content-section"><div class="container"><div class="info-card">
    <h2 class="section-title">Norme NF S 61-932 & obligations</h2><p>@Model.NormeText</p>
  </div></div></section>

  <section class="content-section"><div class="container">
    <h2 class="section-title">Missions de réception</h2>
    <div class="row">
      @for (int i = 0; i < Model.PhaseReception.Count; i++)
      {
        <div class="col-lg-3 mb-4">
          <div class="info-card h-100">
            <div class="number-badge">@((i + 1).ToString())</div>
            <h3>@Model.PhaseReception[i]</h3>
          </div>
        </div>
      }
    </div>
  </div></section>

  <section class="content-section"><div class="container"><div class="info-card"><h2 class="section-title">Obligation ERP</h2><p>@Model.ObligationText</p></div></div></section>

  <section class="content-section"><div class="container"><div class="info-card"><h2 class="section-title">Notre bureau d’études</h2><p>@Model.BureauEtudesText</p></div></div></section>

  <section class="content-section"><div class="container"><div class="info-card">
    <h2 class="section-title">CCF – Exemples de contenu</h2>
    <ul>@foreach (var p in Model.CcfPoints){ <li>@p</li> }</ul>
  </div></div></section>

  <section class="content-section"><div class="container"><div class="info-card highlight-box">
    <h3>Cohérence & conformité</h3><p>@Model.CoherenceText</p>
  </div></div></section>

  <section class="content-section"><div class="container"><div class="info-card text-center">
    <h3>Nous contacter</h3><p>@Model.ContactText</p><a class="btn-primary-custom" href="/contact">Formulaire en ligne</a>
  </div></div></section>

  <section class="content-section"><div class="container"><h2 class="section-title">Zones d’intervention</h2><div class="city-links">
    @foreach (var c in Model.Cities) { <a>@c</a> }
  </div></div></section>


<CtaBar Title="@Model.Cta.Title" Text="@Model.Cta.Text" />

  @* <CtaBar Title="@Model.Cta.Title" Text="@Model.Cta.Text" CtaText="@Model.Cta.ButtonText" CtaHref="@Model.Cta.ButtonHref" IconClass="fas fa-comments" /> *@
}
