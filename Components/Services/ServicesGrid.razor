@using Coossi.Blazor.Data
@using Coossi.Blazor.Data.Interfaces
@using Coossi.Blazor.Data.Models
@inject IContentStore ContentStore

@code {
    [Parameter] public IEnumerable<PrestationItem>? Items { get; set; }
    [Parameter] public string? JsonId { get; set; } // ex: "prestations/_index"

    private List<PrestationItem>? Data;

    protected override async Task OnParametersSetAsync()
    {
        if (Items is not null) { Data = Items.ToList(); return; }

        if (!string.IsNullOrWhiteSpace(JsonId))
        {
            var doc = await ContentStore.GetAsync<PrestationsIndex>(JsonId);
            Data = doc?.Items?.ToList();
        }
    }
}

@if (Data is null)
{
    <section class="section-padding"><div class="container text-center text-muted"><div class="spinner-border text-danger"></div></div></section>
}
else
{
    <section class="section-padding">
        <div class="container">
            <div class="row g-4">
                @foreach (var s in Data)
                {
                    <div class="col-md-6 col-lg-4">
                        <ServiceCard Title="@s.Title"
                                     Icon="@s.Icon"
                                     Href="@($"/prestation/{s.Slug}")"
                                     Excerpt="@s.Excerpt"
                                     Bullets="@s.Bullets" />
                    </div>
                }
            </div>
        </div>
    </section>
}
